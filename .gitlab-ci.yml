etl:
  image: docker:25.0-git
  services:
    - docker:27.5-dind
  script:
    - pwd
    - ls -al /builds/padme-development/external/better/data-cataloging/etl
    - ls -al /builds/padme-development/external/better/data-cataloging/etl/datasets
    - cp .env.ci .env
    - cat .env
    - export CONTEXT_MODE="TEST"
    - export ETL_ENV_FILE_NAME=.env.ci
    - export ABSOLUTE_PATH_ENV_FILE=/builds/padme-development/external/better/data-cataloging/etl/.env.ci
    - docker build . --tag etl
    - docker compose --env-file .env.ci up --exit-code-from etl || true
    - docker compose --env-file .env.ci down